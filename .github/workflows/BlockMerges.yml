 name: Block Feature Merges
 on:
     pull_request:
       branches:
         - 'QA'
         - 'PROD'
    
 jobs:
     block-merging:
       runs-on: ubuntu-latest
       steps:
       - name: Checkout code
         uses: actions/checkout@v2
       - name: Block feature branch merges
         run: |
           TARGET_BRANCH=${{ github.base_ref }}
           SOURCE_BRANCH=${{ github.head_ref }}
           if [ "$TARGET_BRANCH" = "QA" ]; then
            if [ "$SOURCE_BRANCH" != "DEV" ]; then
              echo "Merging from DEV branch is only allowed."
              echo "$TARGET_BRANCH,$SOURCE_BRANCH"
              exit 1
            fi
           elseif [ "$TARGET_BRANCH" = "PROD" ]; then
            if [ "$SOURCE_BRANCH" != "QA" ]; then
              echo "Merging from QA branch is only allowed."
              exit 1
            fi
           fi
            
